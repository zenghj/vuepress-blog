(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{442:function(t,e,_){t.exports=_.p+"assets/img/cdn-header1.c946bd7a.png"},443:function(t,e,_){t.exports=_.p+"assets/img/cdn-header.75991189.png"},503:function(t,e,_){"use strict";_.r(e);var v=_(9),a=Object(v.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("p",[t._v("使用阿里云cdn服务托管整个页面的前端资源（html + css + js），部署更新html资源之后，发现客户端（Android webview）访问页面时页面没有更新到新的页面。查看html资源的响应头如下：")]),t._v(" "),v("p",[v("img",{attrs:{src:_(442),alt:""}})]),t._v(" "),v("p",[t._v("按理来说，是可以通过"),v("code",[t._v("last-modified")]),t._v("字段使用协商缓存策略的，更新html资源之后，用户应该能够拿到新的hmtl资源。")]),t._v(" "),v("p",[t._v("通过"),v("a",{attrs:{href:"https://www.jianshu.com/p/4e5049101271",target:"_blank",rel:"noopener noreferrer"}},[t._v("查资料"),v("OutboundLink")],1),t._v("发现，android webview的缓存策略好像和平常的认知有点不同")]),t._v(" "),v("p",[t._v("webview支持5中缓存模式：")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("LOAD_CACHE_ONLY: 不发网络请求资源，只读取缓存。")])]),t._v(" "),v("li",[v("p",[t._v("LOAD_DEFAULT: 根据cache-control或者Last-Modified决定是否从网络上取数据。默认采用该方案")])]),t._v(" "),v("li",[v("p",[t._v("LOAD_CACHE_NORMAL: 新版本已经废弃，同LOAD_DEFAULT")])]),t._v(" "),v("li",[v("p",[t._v("LOAD_NO_CACHE: 不使用缓存，只从网络获取数据。")])]),t._v(" "),v("li",[v("p",[t._v("LOAD_CACHE_ELSE_NETWORK:只要本地有，无论是否过期，或者no-cache，都使用缓存中的数据。本地没有缓存时才从网络上获取。")])])]),t._v(" "),v("p",[t._v("在没有配置"),v("code",[t._v("cache-control")]),t._v("字段的情况下，浏览器会使用启发式算法策略：通过采用请求响应头中的Date减轻Last-Modified的值的10%作为缓存时间，即在这10%的时间内不发请求，直接使用缓存资源。")]),t._v(" "),v("p",[t._v("所以会出现更新html资源之后依然没有访问到新的页面。")]),t._v(" "),v("p",[t._v("解决方式就是给html资源配置"),v("code",[t._v("cache-control: no-cache")]),t._v("响应头")]),t._v(" "),v("p",[v("img",{attrs:{src:_(443),alt:""}})]),t._v(" "),v("h2",{attrs:{id:"参考"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),v("ul",[v("li",[t._v("https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ")])])])}),[],!1,null,null,null);e.default=a.exports}}]);